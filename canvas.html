<!DOCTYPE html>
<html lang="en" from>

<head>
    <style cmp>

    </style>
    <script>
        var _width = 500
        var _height = 506
        document.querySelector('style[cmp]').textContent = `
        .canvas_wrapper {
    width: ${_width}px;
    height: ${_height}px;
        }
        `;
    </script>
    <script>
        window.previousInnerWidth = innerWidth
        window.previousInnerHeight = innerHeight

        var _innerWidth = innerWidth
        var _innerHeight = innerHeight
        var canvas_events;
        // window.hasOwnProperty('ontouchmove')
        window.onresize = function () {
            // console.log(window.ontouchmove);
            // console.log(window.navigator.userAgent);
            if (window.navigator.userAgent.match(/Mobile|Android/)) {
                document.documentElement.setAttribute('from', 'mobile')
                canvas_events = {
                    mousemove: "ontouchmove",
                    mouseup: "ontouchend",
                    mousedown: "ontouchstart",
                    mouseleave: "ontouchcancel"
                }
            } else {
                document.documentElement.setAttribute('from', 'pc')
                canvas_events = {
                    mousemove: "onmousemove",
                    mouseup: "onmouseup",
                    mousedown: "onmousedown",
                    mouseleave: "onmouseleave"
                }
            }

            if (canvas_board) {
                _innerWidth = canvas_board.offsetWidth
                _innerHeight = canvas_board.offsetHeight
                // if (innerWidth<500) {

                // } else if() {

                // }
                var zoom
                // if (_width>_height && ) {

                // }
                if (previousInnerWidth !== innerWidth) {
                    if (_width > _height) {
                        zoom = _innerWidth / (_width + ((_width + _height) / _height))
                    } else {
                        zoom = _innerHeight / (_height + ((_width + _height) / _width))
                    }
                } else {
                    if (_height > _width) {
                        zoom = _innerHeight / (_height + ((_width + _height) / _width))
                    } else {
                        zoom = _innerWidth / (_width + ((_width + _height) / _height))
                    }
                }
                //     zoom=_innerWidth/((_width>_height?_width:_height)+((_width+_height)/(_width>_height?_width:_height)))
                // } 
                // if (previousInnerHeight!== innerHeight) {
                //     zoom=_innerHeight/((_width>_height?_width:_height)+((_width+_height)/(_width>_height?_width:_height)))
                //     //     zoom=_innerWidth/(_width+((_width+_height)/_width))
                // }
                //  zoom=_innerHeight/(_height+((_width+_height)/_width))
                //  if (_height>_innerHeight||_width>_innerWidth) {
                if (zoom >= 1) {
                    zoom = 1
                }
                //  }
                canvas_wrapper.style.zoom = zoom
            }

            window.previousInnerWidth = innerWidth
            window.previousInnerHeight = innerHeight
        }
        window.onresize()
    </script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style/main.css">
    <link rel="stylesheet" href="style/canva.css">
    <link rel="stylesheet" href="style/ui.css">
    <script src="lib/nimo-DB.js"></script>
    <script>
        var store
        var storeIMGD
        var localStore
        var project_name = 'my editor'

        var ready = new Promise(function (_r) {
            new Promise(function (r) {
                new NimoDB().open(project_name, 'image logs').then(function (e) {
                    if (e) {
                        r(e)
                    } else {
                        new NimoDB().create(project_name, 'image logs').then(r);
                    }
                });
            }).then(function (e) {
                store = e
                new NimoDB().open(project_name, 'image objects').then(function (e) {
                    if (e) {
                        _r(e)
                    } else {
                        new NimoDB().openCreatedDatabase(project_name).then(function () {
                            arguments[0].createTable('image objects').then(function () {
                                _r()
                            });
                            setTimeout(function () {
                                var img = new Image();
                                img.src = "image/1.png"
                                img.onload = function () {
                                    imageToCanvas(img)
                                }
                            }, 0)
                        });
                    }
                });
            });
        });
    </script>
    <title>Canvas</title>
</head>

<body>
    <article>
        <header>
            <h1 center ellipsis>Canva</h1>
        </header>
        <main class="canvas_board">
            <div class="canvas_wrapper">
            </div>
        </main>
        <footer>
            <div class="ft">
                <div image="add" onclick="getImage()">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="feather feather-image">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                    </div>
                    <h5 class="span">Import Image</h5>
                </div>
                <div image="remove" onclick="remove()">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="feather feather-trash">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                            </path>
                        </svg>
                    </div>
                    <h5 class="span">Remove Image</h5>
                </div>
                <div image="clone" onclick="clone()">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="feather feather-copy">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                    </div>
                    <h5 class="span">Clone</h5>
                </div>
                <div image="text" onclick="getText()">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="feather feather-type">
                            <polyline points="4 7 4 4 20 4 20 7"></polyline>
                            <line x1="9" y1="20" x2="15" y2="20"></line>
                            <line x1="12" y1="4" x2="12" y2="20"></line>
                        </svg>
                    </div>
                    <h5 class="span">Text</h5>
                </div>
                <div image="overlay" onclick="overlay()">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="feather feather-layers">
                            <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                            <polyline points="2 17 12 22 22 17"></polyline>
                            <polyline points="2 12 12 17 22 12"></polyline>
                        </svg>
                    </div>
                    <h5 class="span">Overlay</h5>
                </div>
                <div image="crop">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="feather feather-crop">
                            <path d="M6.13 1L6 16a2 2 0 0 0 2 2h15"></path>
                            <path d="M1 6.13L16 6a2 2 0 0 1 2 2v15"></path>
                        </svg>
                    </div>
                    <h5 class="span">Crop</h5>
                </div>
            </div>
        </footer>
    </article>
    <script src="script/main copy.js"></script>
    <script>
        window.onresize()
        setTimeout(function () {
            document.documentElement.setAttribute('ready', 'true')
        }, 3200)
    </script>
</body>

</html>